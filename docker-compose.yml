services:
  minecraft:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        MINECRAFT_VERSION: ${MINECRAFT_VERSION:-1.21.1}
        PAPER_BUILD: ${PAPER_BUILD:-latest}
    container_name: balbescraft
    restart: unless-stopped
    stdin_open: true
    tty: true
    ports:
      - "${SERVER_PORT:-25565}:25565"
    environment:
      - MIN_RAM=${MIN_RAM:-2G}
      - MAX_RAM=${MAX_RAM:-10G}
      - SEED=${SEED:-}
      - WHITELIST_ENABLED=${WHITELIST_ENABLED:-false}
      - MOTD=${MOTD:-A Minecraft Server}
      - MAX_PLAYERS=${MAX_PLAYERS:-20}
      - DIFFICULTY=${DIFFICULTY:-normal}
      - GAMEMODE=${GAMEMODE:-survival}
      - VIEW_DISTANCE=${VIEW_DISTANCE:-10}
      - SIMULATION_DISTANCE=${SIMULATION_DISTANCE:-10}
      - TZ=${TZ:-UTC}
    volumes:
      # World data persistence (Docker named volumes)
      - world_data:/server/world
      - world_nether:/server/world_nether
      - world_the_end:/server/world_the_end
      
      # Configuration files (bind mounts for easy editing)
      - ./config/whitelist.json:/server/whitelist.json:rw
      - ./config/ops.json:/server/ops.json:rw
      - ./config/banned-players.json:/server/banned-players.json:rw
      - ./config/banned-ips.json:/server/banned-ips.json:rw
      
      # Plugins directory (bind mount - add your plugins here)
      - ./plugins:/server/plugins:rw
      
      # Datapacks directory (bind mount for easy datapack installation)
      - ./datapacks:/server/datapacks:ro
      
      # Logs (bind mount for easy access)
      - ./logs:/server/logs:rw

volumes:
  world_data:
    name: balbescraft_world
  world_nether:
    name: balbescraft_world_nether
  world_the_end:
    name: balbescraft_world_the_end